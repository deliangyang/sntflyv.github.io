import{_ as s,c as n,o as a,a as l}from"./app.0ce55433.js";const A=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":3,"title":"\u5982\u4F55\u4F7F\u7528 jq","slug":"\u5982\u4F55\u4F7F\u7528-jq","link":"#\u5982\u4F55\u4F7F\u7528-jq","children":[]},{"level":2,"title":"jq \u652F\u6301\u7684\u529F\u80FD","slug":"jq-\u652F\u6301\u7684\u529F\u80FD","link":"#jq-\u652F\u6301\u7684\u529F\u80FD","children":[]},{"level":2,"title":"\u5B9E\u6218","slug":"\u5B9E\u6218","link":"#\u5B9E\u6218","children":[{"level":3,"title":"\u5206\u6790\u65E5\u5FD7","slug":"\u5206\u6790\u65E5\u5FD7","link":"#\u5206\u6790\u65E5\u5FD7","children":[]}]},{"level":2,"title":"\u5BF9\u6BD4\u6D4B\u8BD5","slug":"\u5BF9\u6BD4\u6D4B\u8BD5","link":"#\u5BF9\u6BD4\u6D4B\u8BD5","children":[{"level":3,"title":"\u4EE3\u7801\u5982\u4E0B","slug":"\u4EE3\u7801\u5982\u4E0B","link":"#\u4EE3\u7801\u5982\u4E0B","children":[]}]},{"level":2,"title":"\u603B\u7ED3","slug":"\u603B\u7ED3","link":"#\u603B\u7ED3","children":[]}],"relativePath":"t/Linux/2020/2020-09-01-linux-tools-jq-json-processor.md","lastUpdated":1729589704000}'),p={name:"t/Linux/2020/2020-09-01-linux-tools-jq-json-processor.md"},o=l(`<blockquote><p>jq \u4E00\u4E2A\u547D\u4EE4\u884C\u7684 JSON \u5904\u7406\u5668</p></blockquote><h3 id="\u5982\u4F55\u4F7F\u7528-jq" tabindex="-1">\u5982\u4F55\u4F7F\u7528 jq <a class="header-anchor" href="#\u5982\u4F55\u4F7F\u7528-jq" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;foo&quot;: &quot;bar&quot;}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#82AAFF;">.</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bar</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="\u83B7\u53D6foo\u7684\u503C" tabindex="-1">\u83B7\u53D6<code>foo</code>\u7684\u503C <a class="header-anchor" href="#\u83B7\u53D6foo\u7684\u503C" aria-hidden="true">#</a></h4><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;foo&quot;: &quot;bar&quot;}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq .foo</span></span>
<span class="line"><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">bar</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="\u4ECE-json-\u4E2D\u83B7\u53D6\u591A\u4E2A\u5B57\u6BB5\u7684\u503C" tabindex="-1">\u4ECE JSON \u4E2D\u83B7\u53D6\u591A\u4E2A\u5B57\u6BB5\u7684\u503C <a class="header-anchor" href="#\u4ECE-json-\u4E2D\u83B7\u53D6\u591A\u4E2A\u5B57\u6BB5\u7684\u503C" aria-hidden="true">#</a></h4><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;foo&quot;: 1, &quot;bar&quot;: 2}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[.foo, .bar]</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">  1,</span></span>
<span class="line"><span style="color:#A6ACCD;">  2</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="\u4F7F\u7528-tsv\u751F\u6210\u5236\u8868\u7B26\u5206\u9694\u503C\u4F5C\u4E3A\u8F93\u51FA" tabindex="-1">\u4F7F\u7528<code>@tsv</code>\u751F\u6210\u5236\u8868\u7B26\u5206\u9694\u503C\u4F5C\u4E3A\u8F93\u51FA <a class="header-anchor" href="#\u4F7F\u7528-tsv\u751F\u6210\u5236\u8868\u7B26\u5206\u9694\u503C\u4F5C\u4E3A\u8F93\u51FA" aria-hidden="true">#</a></h4><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;foo&quot;: 1, &quot;bar&quot;: 2}{&quot;foo&quot;: 3, &quot;bar&quot;: 4}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq -r </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[.foo, .bar] | @tsv</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">1	2</span></span>
<span class="line"><span style="color:#A6ACCD;">3	4</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="jq-\u9009\u62E9\u5B57\u6BB5\u5305\u542B\u67D0\u503C\u7684-json" tabindex="-1">jq \u9009\u62E9\u5B57\u6BB5\u5305\u542B\u67D0\u503C\u7684 JSON <a class="header-anchor" href="#jq-\u9009\u62E9\u5B57\u6BB5\u5305\u542B\u67D0\u503C\u7684-json" aria-hidden="true">#</a></h4><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;foo&quot;: 1}{&quot;foo&quot;:2}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">select(.foo == 1)</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: 1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="jq-\u652F\u6301\u7684\u529F\u80FD" tabindex="-1">jq \u652F\u6301\u7684\u529F\u80FD <a class="header-anchor" href="#jq-\u652F\u6301\u7684\u529F\u80FD" aria-hidden="true">#</a></h2><ul><li>\u6570\u636E\u7D22\u5F15</li></ul><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[1, 2, 3]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.[0]</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">1</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>\u5207\u7247</li></ul><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[1, 2, 3]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.[0:2]</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    1,</span></span>
<span class="line"><span style="color:#A6ACCD;">    2</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>\u53EF\u4EE5\u5B9E\u73B0 php \u7684 array_values\uFF0C\u83B7\u53D6\u5B57\u5178\u5BF9\u8C61\u7684\u503C</li></ul><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;a&quot;: 1, &quot;b&quot;: 1}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.[]</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;user&quot;:&quot;stedolan&quot;, &quot;projects&quot;: [&quot;jq&quot;, &quot;wikiflow&quot;]}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.user, .projects[]</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>\u5B9E\u73B0 php \u7684 array_keys\uFF0C\u83B7\u53D6\u5B57\u5178\u5BF9\u8C61\u7684 key \u540D</li></ul><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> {</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: 1, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">abcd</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: 2, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: 3} </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">keys</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Foo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">abcd</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>\u6570\u5B66\u8FD0\u7B97</li></ul><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{&quot;a&quot;: 7}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.a + 1</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="\u5B9E\u6218" tabindex="-1">\u5B9E\u6218 <a class="header-anchor" href="#\u5B9E\u6218" aria-hidden="true">#</a></h2><h3 id="\u5206\u6790\u65E5\u5FD7" tabindex="-1">\u5206\u6790\u65E5\u5FD7 <a class="header-anchor" href="#\u5206\u6790\u65E5\u5FD7" aria-hidden="true">#</a></h3><p>\u4ECE\u65E5\u5FD7\u4E2D\u83B7\u53D6\u7528\u6237 ID\uFF0C\u8BF7\u6C42\u65B9\u6CD5\uFF0C\u8BF7\u6C42\u8DEF\u5F84\uFF0CIP \u7B49\u6570\u636E\uFF0C\u90A3\u4E48\u4F7F\u7528\u5982\u4E0B\u7684\u547D\u4EE4\uFF0C\u5C31\u53EF\u4EE5\u5F88\u5FEB\u7684\u63D0\u53D6\u51FA\u4F60\u6240\u9700\u8981\u7684\u6570\u636E\u4E86\u3002</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">grep -oP </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{.+}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> /tmp/standard-request-2020082800 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> jq -r </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[.user, .method, .path, .ip] | @tsv</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">16239323	GET	/api/config	39.10.111.91</span></span>
<span class="line"><span style="color:#A6ACCD;">18712163	GET	/api/room/rankings	183.90.136.182</span></span>
<span class="line"><span style="color:#A6ACCD;">11230503	GET	/api/user/panel	219.192.217.116</span></span>
<span class="line"><span style="color:#A6ACCD;">19112230	GET	/api/user/notification	116.186.136.130</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u7EDF\u8BA1\u4E86\u4E00\u4E0B\uFF0C5,006,012 \u884C\u65E5\u5FD7\u5355\u6761\u547D\u4EE4\u5904\u7406\u65F6\u95F4\u5927\u6982 7 \u591A\u949F\uFF0C\u5927\u6982 <code>11124.47 docs/s</code>, \u901F\u5EA6\u8FD8\u662F\u76F8\u5F53\u53EF\u4EE5\u7684\uFF0C\u5982\u679C\u4F7F\u7528 <code>split</code> \u5207\u5206\u6210\u591A\u4E2A\u6587\u4EF6\uFF0C\u5E76\u884C\u5904\u7406\u4E4B\u540E\uFF0C\u518D\u5408\u5E76\uFF0C\u8FD9\u6837\u901F\u5EA6\u4F1A\u66F4\u5FEB\u3002</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">real	7m34.540s</span></span>
<span class="line"><span style="color:#A6ACCD;">user	7m52.144s</span></span>
<span class="line"><span style="color:#A6ACCD;">sys	0m24.824s</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="\u5BF9\u6BD4\u6D4B\u8BD5" tabindex="-1">\u5BF9\u6BD4\u6D4B\u8BD5 <a class="header-anchor" href="#\u5BF9\u6BD4\u6D4B\u8BD5" aria-hidden="true">#</a></h2><p>\u4E3A\u4E86\u9A8C\u8BC1\u4E00\u4E0B shell \u7684\u9AD8\u6548\u5904\u7406\uFF0C\u4E8E\u662F\u6211\u7528 Golang \u5199\u4E86\u4E00\u4E2A\u7A0B\u5E8F\u6765\u5904\u7406\uFF0C\u8FBE\u5230\u76F8\u540C\u7684\u6548\u679C\uFF0C\u7ED3\u679C\u8BA9\u6211\u5931\u671B\u4E86\uFF0C\u7ADF\u7136 Golang \u5904\u7406\u53EA\u9700\u8981 6 \u5206\u949F\u3002\u5176\u5B9E\u611F\u89C9\u8FD8\u597D\u5427\uFF0C\u6BD5\u7ADF\u5199\u7A0B\u5E8F\u82B1\u8D39\u7684\u65F6\u95F4\u4F1A\u957F\u4E00\u4E9B\u3002</p><h3 id="\u4EE3\u7801\u5982\u4E0B" tabindex="-1">\u4EE3\u7801\u5982\u4E0B <a class="header-anchor" href="#\u4EE3\u7801\u5982\u4E0B" aria-hidden="true">#</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">go build cmd/calc/main.go</span></span>
<span class="line"><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> ./main -log /tmp/standard-request-2020082800  </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> 1.txt</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">real	5m58.671s</span></span>
<span class="line"><span style="color:#A6ACCD;">user	5m58.858s</span></span>
<span class="line"><span style="color:#A6ACCD;">sys	0m24.796s</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">main</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">bufio</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">encoding/json</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">flag</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">fmt</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">io</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">log</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">os</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">strings</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Info</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">struct</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	User </span><span style="color:#C792EA;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">json:&quot;user&quot;</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">	IP </span><span style="color:#C792EA;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">json:&quot;ip&quot;</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">	Path </span><span style="color:#C792EA;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">json:&quot;path&quot;</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">	Method </span><span style="color:#C792EA;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">json:&quot;method&quot;</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">	logFile </span><span style="color:#C792EA;">string</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">func</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">init</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	flag</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">StringVar</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">logFile</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log file path</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	flag</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Parse</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">func</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> logFile </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatal</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">log file is empty</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">ReadFileContent</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">logFile</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">func</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ReadFileContent</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">filename </span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">	fi</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Open</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">filename</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatal</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">defer</span><span style="color:#A6ACCD;"> fi</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Close</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">	br </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> bufio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">NewReader</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fi</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">		line</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> br</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ReadString</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">			</span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> err </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> io</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">EOF </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">				</span><span style="color:#89DDFF;">break</span></span>
<span class="line"><span style="color:#A6ACCD;">			</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">			log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatal</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">		content </span><span style="color:#89DDFF;">:=</span><span style="color:#A6ACCD;"> line</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">strings</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Index</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">line</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">):]</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">var</span><span style="color:#A6ACCD;"> info Info</span></span>
<span class="line"><span style="color:#A6ACCD;">		err </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> json</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Unmarshal</span><span style="color:#89DDFF;">([]</span><span style="color:#82AAFF;">byte</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">content</span><span style="color:#89DDFF;">),</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span><span style="color:#A6ACCD;">info</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">nil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">			log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatal</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">		fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">info</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">User</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">IP</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Method</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">\\t</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Path</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br></div></div><h2 id="\u603B\u7ED3" tabindex="-1">\u603B\u7ED3 <a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a></h2><ol><li><code>jq</code> \u529F\u80FD\u592A\u5F3A\u5927\u4E86\uFF0C\u53EF\u4EE5\u901A\u8FC7 linux \u547D\u4EE4\u7FFB\u9605\u624B\u518C <code>man jq</code>\uFF0C\u67E5\u770B jq \u7684\u7528\u6CD5\uFF0C\u8FD9\u91CC\u5C31\u4E0D\u9010\u4E00\u4ECB\u7ECD\u4E86\uFF0C\u4F60\u80FD\u60F3\u5230\u7684\u90FD\u6709\u3002</li><li>\u4E3A\u4EC0\u4E48\u559C\u6B22\u7528 jq \u5462\uFF1F\u901A\u5E38\u5904\u7406\u6587\u672C\u7684\u91CF\u6BD4\u8F83\u5927\uFF0C\u81EA\u5DF1\u5199\u7A0B\u5E8F\u5904\u7406\u53EF\u80FD\u592A\u6162\uFF0C\u800C\u4E14\u5199\u7A0B\u5E8F\u9700\u8981\u82B1\u8D39\u4E0D\u5C11\u7684\u65F6\u95F4\uFF0C\u6240\u4EE5\u80FD\u7528 jq \u548C\u5176\u5B83 linux \u547D\u4EE4\u89E3\u51B3\u5C31\u76F4\u63A5\u5199\u547D\u4EE4\u884C\u4E86\u3002</li><li>\u8FD8\u6709\u7528\u547D\u4EE4\u884C\u5904\u7406\u7279\u522B\u7684\u9177\uFF0C\u4EE3\u7801\u77ED\u5C0F\u7CBE\u608D\uFF0C\u5904\u7406\u901F\u5EA6\u5FEB\u3002</li></ol>`,36),e=[o];function r(c,t,D,F,y,i){return a(),n("div",null,e)}const u=s(p,[["render",r]]);export{A as __pageData,u as default};
