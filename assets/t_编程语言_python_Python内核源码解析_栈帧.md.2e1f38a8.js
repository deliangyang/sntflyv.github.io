import{_ as s,c as n,o as a,a as l}from"./app.0ce55433.js";const p="/assets/frame-object.5676d081.png",e="/assets/opcode.a059bde2.png",o="/assets/call-stack.cc770f71.png",u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"t/\u7F16\u7A0B\u8BED\u8A00/python/Python\u5185\u6838\u6E90\u7801\u89E3\u6790/\u6808\u5E27.md","lastUpdated":1729589704000}'),c={name:"t/\u7F16\u7A0B\u8BED\u8A00/python/Python\u5185\u6838\u6E90\u7801\u89E3\u6790/\u6808\u5E27.md"},r=l(`<p>\u6808\u5E27\u662F Python \u865A\u62DF\u673A\u6267\u884C\u7684\u8F7D\u4F53\u4E4B\u4E00\uFF0C\u5B83\u662F\u4E00\u4E2A\u6570\u636E\u7ED3\u6784\uFF0C\u7528\u4E8E\u5B58\u50A8\u4EE3\u7801\u8FD0\u884C\u65F6\u7684\u6570\u636E\u3002\u6BCF\u4E2A\u6808\u5E27\u90FD\u6709\u81EA\u5DF1\u7684\u5C40\u90E8\u53D8\u91CF\u3001\u64CD\u4F5C\u6570\u6808\u3001\u5F02\u5E38\u5904\u7406\u4FE1\u606F\u7B49\u3002\u6808\u5E27\u662F\u4E00\u4E2A\u6808\u7ED3\u6784\uFF0C\u6BCF\u4E2A\u6808\u5E27\u90FD\u6709\u4E00\u4E2A\u6307\u5411\u4E0A\u4E00\u4E2A\u6808\u5E27\u7684\u6307\u9488\uFF0C\u8FD9\u6837\u5C31\u5F62\u6210\u4E86\u4E00\u4E2A\u6808\u5E27\u94FE\u3002</p><p>\u6808\u5E27\u7684\u521B\u5EFA\u548C\u9500\u6BC1\u662F\u7531 Python \u865A\u62DF\u673A\u81EA\u52A8\u5B8C\u6210\u7684\uFF0C\u5F53\u4E00\u4E2A\u51FD\u6570\u88AB\u8C03\u7528\u65F6\uFF0C\u5C31\u4F1A\u521B\u5EFA\u4E00\u4E2A\u6808\u5E27\uFF0C\u5F53\u51FD\u6570\u8FD4\u56DE\u65F6\uFF0C\u5C31\u4F1A\u9500\u6BC1\u8FD9\u4E2A\u6808\u5E27\u3002</p><p>\u6808\u5E27\u7684\u6570\u636E\u7ED3\u6784\u5982\u4E0B\uFF1A</p><div class="language-c line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki"><code><span class="line"><span style="color:#F78C6C;">typedef</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> _frame PyFrameObject</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> _frame </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    PyObject_VAR_HEAD</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">struct</span><span style="color:#F07178;"> _frame </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">f_back</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">      /* previous frame, or NULL \u524D\u4E00\u4E2A\u6808\u5E27 */</span></span>
<span class="line"><span style="color:#F07178;">    PyCodeObject </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">f_code</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">       /* code segment */      // \u4EE3\u7801\u6BB5</span></span>
<span class="line"><span style="color:#F07178;">    PyObject </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">f_builtins</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">       /* builtin symbol table (PyDictObject) \u5185\u7F6E\u7B26\u53F7\u8868\uFF0C\u5B57\u5178 */</span></span>
<span class="line"><span style="color:#F07178;">    PyObject </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">f_globals</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">        /* global symbol table (PyDictObject) \u5168\u5C40\u7B26\u53F7\u8868 \u5B57\u5178 */</span></span>
<span class="line"><span style="color:#F07178;">    PyObject </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">f_locals</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">         /* local symbol table (any mapping)  \u5F53\u524D\u4F5C\u7528\u57DF \u6620\u5C04 */</span></span>
<span class="line"><span style="color:#F07178;">    PyObject </span><span style="color:#89DDFF;">**</span><span style="color:#F07178;">f_valuestack</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">    /* points after the last local */   // \u6307\u5411\u6700\u540E\u4E00\u4E2A\u5C40\u90E8\u53D8\u91CF\u7684\u540E\u9762</span></span>
<span class="line"><span style="color:#F07178;">    PyObject </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">f_trace</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">          /* Trace function */    // \u8DDF\u8E2A\u51FD\u6570</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">int</span><span style="color:#F07178;"> f_stackdepth</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">           /* Depth of value stack */  // \u503C\u6808\u6DF1\u5EA6</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">char</span><span style="color:#F07178;"> f_trace_lines</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">         /* Emit per-line trace events? */ // \u6BCF\u884C\u8DDF\u8E2A\u4E8B\u4EF6</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">char</span><span style="color:#F07178;"> f_trace_opcodes</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">       /* Emit per-opcode trace events? */ // \u6BCF\u4E2A\u64CD\u4F5C\u7801\u8DDF\u8E2A\u4E8B\u4EF6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">    /* Borrowed reference to a generator, or NULL */</span></span>
<span class="line"><span style="color:#F07178;">    PyObject </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;">f_gen</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">        // \u751F\u6210\u5668</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">int</span><span style="color:#F07178;"> f_lasti</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">                /* Last instruction if called */    // \u6700\u540E\u4E00\u6761\u6307\u4EE4</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">int</span><span style="color:#F07178;"> f_lineno</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">               /* Current line number. Only valid if non-zero */   // \u5F53\u524D\u884C\u53F7</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">int</span><span style="color:#F07178;"> f_iblock</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">               /* index in f_blockstack */ // f_blockstack \u7684\u7D22\u5F15</span></span>
<span class="line"><span style="color:#F07178;">    PyFrameState f_state</span><span style="color:#89DDFF;">;</span><span style="color:#676E95;">       /* What state the frame is in \u72B6\u6001 */   // \u6808\u5E27\u7684\u72B6\u6001</span></span>
<span class="line"><span style="color:#F07178;">    PyTryBlock </span><span style="color:#A6ACCD;">f_blockstack</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">CO_MAXBLOCKS</span><span style="color:#89DDFF;">];</span><span style="color:#676E95;"> /* for try and loop blocks  */   // try \u548C loop \u5757\uFF0C\u957F\u5EA6\u4E3A CO_MAXBLOCKS=20</span></span>
<span class="line"><span style="color:#F07178;">    PyObject </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">f_localsplus</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">];</span><span style="color:#676E95;">  /* locals+stack, dynamically sized */   // \u5C40\u90E8\u53D8\u91CF\u548C\u6808\uFF0C\u52A8\u6001\u5730\u957F\u5EA6</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>\u6BCF\u4E2A\u6808\u5E27\u90FD\u6709\u81EA\u5DF1\u7684\u6570\u636E\u6808\uFF0C\u6570\u636E\u6808\u7684\u957F\u5EA6\u662F\u52A8\u6001\u7684\uFF0C\u5B83\u7684\u957F\u5EA6\u662F\u5C40\u90E8\u53D8\u91CF\u7684\u6570\u91CF\u52A0\u4E0A\u6808\u5E27\u7684\u6DF1\u5EA6\u3002\u5C40\u90E8\u53D8\u91CF\u7684\u6570\u91CF\u662F\u7531\u4EE3\u7801\u5BF9\u8C61\u7684 co_nlocals \u5C5E\u6027\u51B3\u5B9A\u7684\uFF0C\u6808\u5E27\u7684\u6DF1\u5EA6\u662F\u7531\u4EE3\u7801\u5BF9\u8C61\u7684 co_stacksize \u5C5E\u6027\u51B3\u5B9A\u7684\u3002</p><p><img src="`+p+`" alt="\u6808\u5E27\u6570\u636E\u7ED3\u6784"></p><p>f_code \u662F\u4EE3\u7801\u6BB5\uFF0C\u5B83\u662F\u4E00\u4E2A PyCodeObject \u5BF9\u8C61\uFF0C\u5B83\u5305\u542B\u4E86\u4EE3\u7801\u5BF9\u8C61\u7684\u6240\u6709\u4FE1\u606F\uFF0C\u5305\u62EC\u5B57\u8282\u7801\u3001\u5E38\u91CF\u8868\u3001\u53D8\u91CF\u540D\u7B49\u3002</p><p>f_builtins \u662F\u5185\u7F6E\u7B26\u53F7\u8868\uFF0C\u5B83\u662F\u4E00\u4E2A PyDictObject \u5BF9\u8C61\uFF0C\u5B83\u5305\u542B\u4E86\u5185\u7F6E\u51FD\u6570\u7684\u540D\u79F0\u548C\u51FD\u6570\u5BF9\u8C61\u7684\u6620\u5C04\u5173\u7CFB\u3002</p><p>f_globals \u662F\u5168\u5C40\u7B26\u53F7\u8868\uFF0C\u5B83\u662F\u4E00\u4E2A PyDictObject \u5BF9\u8C61\uFF0C\u5B83\u5305\u542B\u4E86\u5168\u5C40\u53D8\u91CF\u7684\u540D\u79F0\u548C\u53D8\u91CF\u503C\u7684\u6620\u5C04\u5173\u7CFB\u3002</p><p>f_locals \u662F\u5C40\u90E8\u7B26\u53F7\u8868\uFF0C\u5B83\u662F\u4E00\u4E2A PyDictObject \u5BF9\u8C61\uFF0C\u5B83\u5305\u542B\u4E86\u5C40\u90E8\u53D8\u91CF\u7684\u540D\u79F0\u548C\u53D8\u91CF\u503C\u7684\u6620\u5C04\u5173\u7CFB\u3002</p><p>f_valuestack \u662F\u503C\u6808\uFF0C\u5B83\u662F\u4E00\u4E2A PyObject \u5BF9\u8C61\u7684\u6570\u7EC4\uFF0C\u5B83\u5305\u542B\u4E86\u5C40\u90E8\u53D8\u91CF\u548C\u64CD\u4F5C\u6570\u6808\u7684\u503C\u3002</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki"><code><span class="line"><span style="color:#A6ACCD;">a </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">b </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#A6ACCD;">c </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> a </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> b</span></span>
<span class="line"><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">c</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="`+e+`" alt="\u64CD\u4F5C\u7801\u8C03\u7528"></p><p>Python \u7684\u8C03\u7528\u6808\u6709\u591A\u4E2A\u6808\u5E27\u7EC4\u6210\uFF0C\u4E00\u5B9A\u5305\u542B main \u6808\u5E27\uFF0Cmain \u6808\u5E27\u662F Python \u865A\u62DF\u673A\u542F\u52A8\u65F6\u521B\u5EFA\u7684\uFF0C\u5B83\u7684 f_back \u6307\u9488\u4E3A NULL\uFF0C\u5176\u5B83\u6808\u5E27\u7684 f_back \u6307\u9488\u90FD\u6307\u5411\u4E0A\u4E00\u4E2A\u6808\u5E27\u3002</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">bar</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">y</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#A6ACCD;">    x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> y </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> x</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">foo</span><span style="color:#89DDFF;">():</span></span>
<span class="line"><span style="color:#A6ACCD;">    a </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">    b </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> a </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">bar</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">b</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">foo</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>main \u6808\u5E27\u8C03\u7528 foo \u6808\u5E27\uFF0Cfoo \u6808\u5E27\u8C03\u7528 bar \u6808\u5E27\uFF0Cbar \u6808\u5E27\u8FD4\u56DE\u5230 foo \u6808\u5E27\uFF0Cfoo \u6808\u5E27\u8FD4\u56DE\u5230 main \u6808\u5E27\u3002\u6BCF\u4E00\u4E2A\u8FD4\u56DE\u90FD\u4F1A\u9500\u6BC1\u4E00\u4E2A\u6808\u5E27\u3002\u7A0B\u5E8F\u7ED3\u675F\uFF0Cmain \u6808\u5E27\u4E5F\u4F1A\u88AB\u9500\u6BC1\u3002</p><p><img src="`+o+'" alt="\u8C03\u7528\u6808"></p>',17),t=[r];function y(i,F,b,D,C,A){return a(),n("div",null,t)}const _=s(c,[["render",y]]);export{u as __pageData,_ as default};
